!-----------------------------------------------------------------------
module p__passx
!-----------------------------------------------------------------------
  use c__eprm,  only: lx1,lx2,npa1
  use v__in,    only: delt
  use p__initmg,only: delx
  implicit none
!
  private
  public :: passx
!
  contains
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
  subroutine passx( xp1,vp1,pind )
!-----------------------------------------------------------------------
    real(kind=8)   ,intent(inout) ::  vp1(3,npa1),xp1(npa1)
    integer(kind=4),intent(inout) ::  pind(npa1)
!
    real(kind=8) ::   aa,bb,raa1,rba1,half,hdelt
    integer           ii,ic,id
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
    half = 0.5d0
    hdelt = half*delt
!-----------------------------------------------------------------------
    do ii = 1,npa1
!-----------------------------------------------------------------------
      if( pind(ii).eq.0 ) then
!-----------------------------------------------------------------------
        xp1(ii) = xp1(ii) + vp1(1,ii)*delt
!        xp1(ii) = xp1(ii) + vp1(1,ii)*hdelt
!-----------------------------------------------------------------------
        aa   = xp1(ii)/delx
        raa1 = dint( aa+half )
        ic   = raa1
!-----------------------------------------------------------------------
        if( ic.le.lx1-1 ) then
           pind(ii) = 1
        else if( ic.gt.lx2+1 ) then
           pind(ii) = 2
        endif
!-----------------------------------------------------------------------
      end if
!-----------------------------------------------------------------------
    end do
!-----------------------------------------------------------------------
    return
!-----------------------------------------------------------------------
  end subroutine passx
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
end module p__passx
